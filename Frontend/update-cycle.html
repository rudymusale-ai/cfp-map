<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Nouveau cycle annuel</title>
<link rel="stylesheet" href="theme.css">

<style>
.cycle-card{
  max-width:480px;
  margin:0 auto;
  text-align:center;
  padding:28px 24px;
}
.status{
  margin-top:15px;
  color:#15803d;
}
</style>
</head>

<body>

<div id="nav-placeholder"></div>

<div class="page">
<div class="card cycle-card">

<h2>üîÅ Mise √† jour annuelle</h2>

<p>
Cette action va :

<br>‚úî Archiver les anciennes donn√©es  
<br>‚úî Cr√©er un nouveau cycle  
<br>‚úî R√©initialiser les statistiques  
</p>

<button class="btn btn-primary" onclick="startCycle()">‚û° D√©marrer nouveau cycle</button>

<div class="status" id="status"></div>

</div>
</div>

<script src="app-data.js?v=20260207"></script>
<script>

function startCycle(){

if(!confirm("Confirmer d√©marrage nouveau cycle ? Cette action est irr√©versible.")) return;

fetch('/update-cycle',{
 method:"POST"
})
.then(r=>r.json())
.then(res=>{
 document.getElementById("status").innerText =
 "Nouveau cycle cr√©√© : " + res.version;
})
.catch(()=>{
  const version = AppData.incrementCycle();
  document.getElementById("status").innerText =
  "Nouveau cycle cr√©√© (local) : " + version;
});

}

</script>
<script src="nav-auth.js"></script>
<script>
initNavAuth();
</script>

</body>
</html>

